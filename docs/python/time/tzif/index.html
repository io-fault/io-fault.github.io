<html root="2"><head><title>fault.time.tzif</title><meta charset="utf-8"/><link as="style" rel="preload" href="../../.legacy-web/core.css"></link><link as="style" rel="preload" href="../../.legacy-web/factor.css"></link><link rel="stylesheet" href="../../.legacy-web/core.css"></link><link rel="stylesheet" href="../../.legacy-web/factor.css"></link></head><body><main><h1><span class="prefix"></span><div class="page-subject"><img class="icon" src="../../.factor-type-icon/if.fault.io/python-module.svg"></img><span class="subject-identifier">tzif</span><a href="http://if.fault.io/factors/python.module"><code class="type">python.module</code></a></div><div class="page-context"><a href="../"><img class="icon" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNTYiIGhlaWdodD0iMjU2Ij48dGV4dCB4PSI0IiB5PSIwLjg4ZW0iIGZvbnQtc2l6ZT0iMjQ4Ij7ij7M8L3RleHQ+PC9zdmc+"></img></a><span class="context-identifier">fault.time</span></div></h1><section class="chapter"><p><span class="text.normal">Read TZif, time zone information, files(zic output).</span></p><div class="admonition-WARNING"><table><tr><td><span class="admonition.icon"></span></td><td><span class="admonition.severity">WARNING</span></td></tr><tr><td></td><td><div class="admonition.content"><p><span class="text.normal">This module is intended for internal use only.</span><span class="text.line-break"> </span><span class="text.normal">The APIs are subject to change without notice.</span></p></div></td></tr></table></div></section><section class="import" documented="false" local-identifier="os" id="os"><h1><span class="prefix"></span><a class="title" href="#os"><span class="text.normal">os</span></a><span class="abstract-type">import</span></h1></section><section class="import" documented="false" local-identifier="struct" id="struct"><h1><span class="prefix"></span><a class="title" href="#struct"><span class="text.normal">struct</span></a><span class="abstract-type">import</span></h1></section><section class="import" documented="false" local-identifier="collections" id="collections"><h1><span class="prefix"></span><a class="title" href="#collections"><span class="text.normal">collections</span></a><span class="abstract-type">import</span></h1></section><section class="data" documented="false" local-identifier="magic" id="magic"><h1><span class="prefix"></span><a class="title" href="#magic"><span class="text.normal">magic</span></a><span class="abstract-type">data</span></h1><pre class="text.syntax"><code class="source">magic = b'TZif'
</code></pre></section><section class="data" documented="false" local-identifier="tzdir" id="tzdir"><h1><span class="prefix"></span><a class="title" href="#tzdir"><span class="text.normal">tzdir</span></a><span class="abstract-type">data</span></h1><pre class="text.syntax"><code class="source">tzdir = '/usr/share/zoneinfo'
</code></pre></section><section class="data" documented="false" local-identifier="tzdefault" id="tzdefault"><h1><span class="prefix"></span><a class="title" href="#tzdefault"><span class="text.normal">tzdefault</span></a><span class="abstract-type">data</span></h1><pre class="text.syntax"><code class="source">tzdefault = '/etc/localtime'
</code></pre></section><section class="data" documented="false" local-identifier="tzenviron" id="tzenviron"><h1><span class="prefix"></span><a class="title" href="#tzenviron"><span class="text.normal">tzenviron</span></a><span class="abstract-type">data</span></h1><pre class="text.syntax"><code class="source">tzenviron = 'TZ'
</code></pre></section><section class="data" documented="false" local-identifier="header_fields" id="header_fields"><h1><span class="prefix"></span><a class="title" href="#header_fields"><span class="text.normal">header_fields</span></a><span class="abstract-type">data</span></h1><pre class="text.syntax"><code class="source">header_fields = (
	'tzh_ttisgmtcnt',  # The number of UTC/local indicators stored in the file.
	'tzh_ttisstdcnt',  # The number of standard/wall indicators stored in the file.
	'tzh_leapcnt',     # The number of leap seconds for which data is stored in the file.
	'tzh_timecnt',     # The number of `transition times` for which data is stored in the file.
	'tzh_typecnt',     # The number of `local time types` for which data is stored in the file (must not be zero).
	'tzh_charcnt',     # The number of characters of `time zone abbreviation strings` stored in the file.
)
</code></pre></section><section class="data" documented="false" local-identifier="tzinfo_header" id="tzinfo_header"><h1><span class="prefix"></span><a class="title" href="#tzinfo_header"><span class="text.normal">tzinfo_header</span></a><span class="abstract-type">data</span></h1><pre class="text.syntax"><code class="source">tzinfo_header = collections.namedtuple('tzinfo_header', header_fields)
</code></pre></section><section class="data" documented="false" local-identifier="header_struct_v1" id="header_struct_v1"><h1><span class="prefix"></span><a class="title" href="#header_struct_v1"><span class="text.normal">header_struct_v1</span></a><span class="abstract-type">data</span></h1><pre class="text.syntax"><code class="source">header_struct_v1 = struct.Struct("!" + (len(header_fields) * "l"))
</code></pre></section><section class="data" documented="false" local-identifier="header_struct_v2" id="header_struct_v2"><h1><span class="prefix"></span><a class="title" href="#header_struct_v2"><span class="text.normal">header_struct_v2</span></a><span class="abstract-type">data</span></h1><pre class="text.syntax"><code class="source">header_struct_v2 = struct.Struct("!" + (len(header_fields) * "q"))
</code></pre></section><section class="data" documented="false" local-identifier="ttinfo_fields" id="ttinfo_fields"><h1><span class="prefix"></span><a class="title" href="#ttinfo_fields"><span class="text.normal">ttinfo_fields</span></a><span class="abstract-type">data</span></h1><pre class="text.syntax"><code class="source">ttinfo_fields = (
	'tt_gmtoff',
	'tt_isdst',
	'tt_abbrind',
)
</code></pre></section><section class="data" documented="false" local-identifier="tzinfo_ttinfo" id="tzinfo_ttinfo"><h1><span class="prefix"></span><a class="title" href="#tzinfo_ttinfo"><span class="text.normal">tzinfo_ttinfo</span></a><span class="abstract-type">data</span></h1><pre class="text.syntax"><code class="source">tzinfo_ttinfo = collections.namedtuple('tzinfo_ttinfo', ttinfo_fields)
</code></pre></section><section class="data" documented="false" local-identifier="ttinfo_struct_v1" id="ttinfo_struct_v1"><h1><span class="prefix"></span><a class="title" href="#ttinfo_struct_v1"><span class="text.normal">ttinfo_struct_v1</span></a><span class="abstract-type">data</span></h1><pre class="text.syntax"><code class="source">ttinfo_struct_v1 = struct.Struct("!lbb")
</code></pre></section><section class="data" documented="false" local-identifier="ttinfo_struct_v2" id="ttinfo_struct_v2"><h1><span class="prefix"></span><a class="title" href="#ttinfo_struct_v2"><span class="text.normal">ttinfo_struct_v2</span></a><span class="abstract-type">data</span></h1><pre class="text.syntax"><code class="source">ttinfo_struct_v2 = struct.Struct("!qbb")
</code></pre></section><section class="data" documented="false" local-identifier="transtime_struct_v1" id="transtime_struct_v1"><h1><span class="prefix"></span><a class="title" href="#transtime_struct_v1"><span class="text.normal">transtime_struct_v1</span></a><span class="abstract-type">data</span></h1><pre class="text.syntax"><code class="source">transtime_struct_v1 = struct.Struct("!l")
</code></pre></section><section class="data" documented="false" local-identifier="leappairs_struct_v1" id="leappairs_struct_v1"><h1><span class="prefix"></span><a class="title" href="#leappairs_struct_v1"><span class="text.normal">leappairs_struct_v1</span></a><span class="abstract-type">data</span></h1><pre class="text.syntax"><code class="source">leappairs_struct_v1 = struct.Struct("!ll")
</code></pre></section><section class="data" documented="false" local-identifier="transtime_struct_v2" id="transtime_struct_v2"><h1><span class="prefix"></span><a class="title" href="#transtime_struct_v2"><span class="text.normal">transtime_struct_v2</span></a><span class="abstract-type">data</span></h1><pre class="text.syntax"><code class="source">transtime_struct_v2 = struct.Struct("!q")
</code></pre></section><section class="data" documented="false" local-identifier="leappairs_struct_v2" id="leappairs_struct_v2"><h1><span class="prefix"></span><a class="title" href="#leappairs_struct_v2"><span class="text.normal">leappairs_struct_v2</span></a><span class="abstract-type">data</span></h1><pre class="text.syntax"><code class="source">leappairs_struct_v2 = struct.Struct("!qq")
</code></pre></section><section class="data" documented="false" local-identifier="tzinfo" id="tzinfo"><h1><span class="prefix"></span><a class="title" href="#tzinfo"><span class="text.normal">tzinfo</span></a><span class="abstract-type">data</span></h1><pre class="text.syntax"><code class="source">tzinfo = collections.namedtuple('tzinfo', (
	'header',
	'transitional_times',
	'types',
	'typinfo'
))
</code></pre><pre class="text.syntax"><code class="source">tzinfo = collections.namedtuple('tzinfo', (
	'tz_abbrev',
	'tz_offset',
	'tz_isdst',
	'tz_isstd',
	'tz_isgmt',
))
</code></pre></section><section class="function" documented="true" local-identifier="parse_version_1" id="parse_version_1"><h1><span class="prefix"></span><a class="title" href="#parse_version_1"><span class="text.normal">parse_version_1</span></a><span class="abstract-type">function</span></h1><p><code class="signature">parse_version_1(data)</code></p><p><span class="text.normal">parse the raw data from a TZif file. 4-byte longs.</span></p><p><span class="text.normal">Returns tuple of: (transtimes, types, timetypinfo, leaps, isstd, isgmt, abbr)</span><span class="text.line-break"> </span><span class="text.normal">See </span><a class="invalid" href="#tzfile"><span class="unknown">tzfile</span></a><span class="text.normal">(5) for information about the fields.</span></p></section><section class="function" documented="true" local-identifier="parse_version_2" id="parse_version_2"><h1><span class="prefix"></span><a class="title" href="#parse_version_2"><span class="text.normal">parse_version_2</span></a><span class="abstract-type">function</span></h1><p><code class="signature">parse_version_2(data)</code></p><p><span class="text.normal">parse the raw data from a version 2 TZif file. 8-byte longs.</span></p><p><span class="text.normal">Returns tuple of: (transtimes, types, timetypinfo, leaps, isstd, isgmt, abbr)</span><span class="text.line-break"> </span><span class="text.normal">See </span><a class="invalid" href="#tzfile"><span class="unknown">tzfile</span></a><span class="text.normal">(5) for information about the fields.</span></p></section><section class="function" documented="true" local-identifier="parse" id="parse"><h1><span class="prefix"></span><a class="title" href="#parse"><span class="text.normal">parse</span></a><span class="abstract-type">function</span></h1><p><code class="signature">parse(data)</code></p><p><span class="text.normal">Given TZif data, identify the appropriate version and unpack the timezone information.</span></p></section><section class="function" documented="true" local-identifier="structure" id="structure"><h1><span class="prefix"></span><a class="title" href="#structure"><span class="text.normal">structure</span></a><span class="abstract-type">function</span></h1><p><code class="signature">structure(tzif)</code></p><p><span class="text.normal">Given the parse fields from parse(), make a more accessible structure.</span></p></section><section class="function" documented="false" local-identifier="system_timezone_file" id="system_timezone_file"><h1><span class="prefix"></span><a class="title" href="#system_timezone_file"><span class="text.normal">system_timezone_file</span></a><span class="abstract-type">function</span></h1><p><code class="signature">system_timezone_file(relativepath)</code></p></section><section class="function" documented="true" local-identifier="get_timezone_data" id="get_timezone_data"><h1><span class="prefix"></span><a class="title" href="#get_timezone_data"><span class="text.normal">get_timezone_data</span></a><span class="abstract-type">function</span></h1><p><code class="signature">get_timezone_data(filepath)</code></p><p><span class="text.normal">Get the structured timezone data out of the specified file.</span></p></section><section class="function" documented="true" local-identifier="abbreviations" id="abbreviations"><h1><span class="prefix"></span><a class="title" href="#abbreviations"><span class="text.normal">abbreviations</span></a><span class="abstract-type">function</span></h1><p><code class="signature">abbreviations(tzdir)</code></p><p><span class="text.normal">Yield all abbreviations in the TZif files in the tzdir(/usr/share/zoneinfo).</span></p></section><section class="function" documented="true" local-identifier="abbreviation_map" id="abbreviation_map"><h1><span class="prefix"></span><a class="title" href="#abbreviation_map"><span class="text.normal">abbreviation_map</span></a><span class="abstract-type">function</span></h1><p><code class="signature">abbreviation_map()</code></p><p><span class="text.normal">Generate and return a mapping of zone abbreviations to their particular offsets.</span></p><p><span class="text.normal">Using this should mean that you know that abbreviations are ambiguous.</span><span class="text.line-break"> </span><span class="text.normal">This function is provided to aid common cases and popular mappings.</span></p></section><h1 class="footing"></h1></main></body></html>