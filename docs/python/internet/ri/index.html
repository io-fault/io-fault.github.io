<html root="2"><head><title>fault.internet.ri</title><meta charset="utf-8"/><link as="style" rel="preload" href="../../.legacy-web/core.css"></link><link as="style" rel="preload" href="../../.legacy-web/factor.css"></link><link rel="stylesheet" href="../../.legacy-web/core.css"></link><link rel="stylesheet" href="../../.legacy-web/factor.css"></link></head><body><main><h1><span class="prefix"></span><div class="page-subject"><img class="icon" src="../../.factor-type-icon/if.fault.io/python-module.svg"></img><span class="subject-identifier">ri</span><span class="element-status"><span class="nothing-missed">0</span></span><a href="http://if.fault.io/factors/python.module"><code class="type">python.module</code></a></div><div class="page-context"><a href="../"><img class="icon" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNTYiIGhlaWdodD0iMjU2Ij48dGV4dCB4PSI0IiB5PSIwLjg4ZW0iIGZvbnQtc2l6ZT0iMjQ4Ij7wn5OhPC90ZXh0Pjwvc3ZnPg=="></img></a><span class="context-identifier">fault.internet</span></div></h1><section class="chapter"><p><span class="text.normal">Parse, Serialize, and Tokenize Resource Indicators</span></p><p><a class="project-local" href="../ri"><span class="unknown">ri</span></a><span class="text.normal"> provides tools for working with standard IRIs or URIs. However,</span><span class="text.line-break"> </span><span class="text.normal">it is not strict. It does not require exact formatting for a parse</span><span class="text.line-break"> </span><span class="text.normal">operation to succeed; rather, the validation of the output is left</span><span class="text.line-break"> </span><span class="text.normal">to the user.</span></p><p><span class="text.normal">The module refers to IRI and URI strings as Resource Indicators.</span><span class="text.line-break"> </span><span class="text.normal">The distinction is made as the module deals with a slight generalization</span><span class="text.line-break"> </span><span class="text.normal">where constraints are not enforced or checked.</span></p></section><section class="unspecified" documented="true" local-identifier="Entry Points" id="Entry-Points"><h1><span class="prefix"></span><a class="title" href="#Entry-Points"><span class="text.normal">Entry Points</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type"></span></div></h1><ul class="text.set"><li><p><a class="factor-local" href="#parse"><span class="function">parse</span></a></p></li><li><p><a class="factor-local" href="#serialize"><span class="function">serialize</span></a></p></li><li><p><a class="factor-local" href="#tokens"><span class="function">tokens</span></a></p></li></ul></section><section class="unspecified" documented="true" local-identifier="Types" id="Types"><h1><span class="prefix"></span><a class="title" href="#Types"><span class="text.normal">Types</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type"></span></div></h1><p><span class="text.normal">A parsed indicator is designated a type. The set of possible types</span><span class="text.line-break"> </span><span class="text.normal">is inspired by the URI and IRI standards:</span></p><dl class="text.mapping"><div id="Types.authority" documented="true"><dt><a class="dkn" href="#Types.authority"></a><span class="directory-key"><span class="text.normal">authority</span></span></dt><dd><div class="status"></div><p><span class="text.normal">An authority indicator identified by the presence of </span><code class="characters">'://'</code><span class="text.line-break"> </span><span class="text.normal">following the scheme field.</span></p></dd></div><div id="Types.absolute" documented="true"><dt><a class="dkn" href="#Types.absolute"></a><span class="directory-key"><span class="text.normal">absolute</span></span></dt><dd><div class="status"></div><p><span class="text.normal">A colon following the scheme field.</span></p></dd></div><div id="Types.relative" documented="true"><dt><a class="dkn" href="#Types.relative"></a><span class="directory-key"><span class="text.normal">relative</span></span></dt><dd><div class="status"></div><p><span class="text.normal">A pair of slashes following the scheme field. Often, the scheme</span><span class="text.line-break"> </span><span class="text.normal">is implied in these cases.</span></p></dd></div><div id="Types.amorphous" documented="true"><dt><a class="dkn" href="#Types.amorphous"></a><span class="directory-key"><span class="text.normal">amorphous</span></span></dt><dd><div class="status"></div><p><span class="text.normal">The absence of characters that allow the unambiguous identification</span><span class="text.line-break"> </span><span class="text.normal">of a type. Usually indicates a value error.</span></p></dd></div></dl></section><section class="import" documented="false" local-identifier="collections" id="collections"><h1><span class="prefix"></span><a class="title" href="#collections"><span class="text.normal">collections</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">import</span></div></h1></section><section class="data" documented="false" local-identifier="scheme_chars" id="scheme_chars"><h1><span class="prefix"></span><a class="title" href="#scheme_chars"><span class="text.normal">scheme_chars</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">scheme_chars = '-.+0123456789'
</code></pre></section><section class="data" documented="false" local-identifier="reserved_chars" id="reserved_chars"><h1><span class="prefix"></span><a class="title" href="#reserved_chars"><span class="text.normal">reserved_chars</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">reserved_chars = "%!*'();:@&#38;=+$,/?#[]"
</code></pre></section><section class="data" documented="false" local-identifier="_pct_encode" id="_pct_encode"><h1><span class="prefix"></span><a class="title" href="#_pct_encode"><span class="text.normal">_pct_encode</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">_pct_encode = '%%%0.2X'.__mod__
</code></pre></section><section class="function" documented="false" local-identifier="_decode_parts" id="_decode_parts"><h1><span class="prefix"></span><a class="title" href="#_decode_parts"><span class="text.normal">_decode_parts</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">_decode_parts(string)</code></p></section><section class="function" documented="false" local-identifier="decode_percent_escapes" id="decode_percent_escapes"><h1><span class="prefix"></span><a class="title" href="#decode_percent_escapes"><span class="text.normal">decode_percent_escapes</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">decode_percent_escapes(string)</code></p></section><section class="function" documented="true" local-identifier="strict" id="strict"><h1><span class="prefix"></span><a class="title" href="#strict"><span class="text.normal">strict</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">strict()</code></p><p><span class="text.normal">Enable strict serializations.</span><span class="text.line-break"> </span><span class="text.normal">When performed on a cached import, this will effect the entire process.</span></p><p><span class="text.normal">In order to isolate the effect to a certain part of the process, the module should</span><span class="text.line-break"> </span><span class="text.normal">be created from the loader and </span><a class="factor-local" href="#strict"><span class="function">strict</span></a><span class="text.normal"> should be called relative to the local copy.</span></p></section><section class="data" documented="false" local-identifier="_uri_escape" id="_uri_escape"><h1><span class="prefix"></span><a class="title" href="#_uri_escape"><span class="text.normal">_uri_escape</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">_uri_escape = (lambda x: ''.join(map(_pct_encode, x.encode('utf-8'))))
</code></pre></section><section class="data" documented="false" local-identifier="_mktrans" id="_mktrans"><h1><span class="prefix"></span><a class="title" href="#_mktrans"><span class="text.normal">_mktrans</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">_mktrans = (lambda z: str.maketrans({x:_pct_encode(x) for x in [ord(y) for y in z] + list(range(0,33))}))
</code></pre></section><section class="data" documented="false" local-identifier="_percent_translations" id="_percent_translations"><h1><span class="prefix"></span><a class="title" href="#_percent_translations"><span class="text.normal">_percent_translations</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">_percent_translations = _mktrans("%")
</code></pre></section><section class="data" documented="false" local-identifier="_user_percent_translations" id="_user_percent_translations"><h1><span class="prefix"></span><a class="title" href="#_user_percent_translations"><span class="text.normal">_user_percent_translations</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">_user_percent_translations = _mktrans("%@:/?#")
</code></pre></section><section class="data" documented="false" local-identifier="_password_percent_translations" id="_password_percent_translations"><h1><span class="prefix"></span><a class="title" href="#_password_percent_translations"><span class="text.normal">_password_percent_translations</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">_password_percent_translations = _mktrans("%@/?#")
</code></pre></section><section class="data" documented="false" local-identifier="_host_percent_translations" id="_host_percent_translations"><h1><span class="prefix"></span><a class="title" href="#_host_percent_translations"><span class="text.normal">_host_percent_translations</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">_host_percent_translations = \
_address_percent_translations = \
_port_percent_translations = \
_primary_percent_translations = _mktrans("%/?#")
</code></pre></section><section class="data" documented="false" local-identifier="_fragment_percent_translations" id="_fragment_percent_translations"><h1><span class="prefix"></span><a class="title" href="#_fragment_percent_translations"><span class="text.normal">_fragment_percent_translations</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">_fragment_percent_translations = _mktrans("%?#")
</code></pre></section><section class="data" documented="false" local-identifier="_query_key_percent_translations" id="_query_key_percent_translations"><h1><span class="prefix"></span><a class="title" href="#_query_key_percent_translations"><span class="text.normal">_query_key_percent_translations</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">_query_key_percent_translations = _mktrans("%&#38;#=")
</code></pre></section><section class="data" documented="false" local-identifier="_query_value_percent_translations" id="_query_value_percent_translations"><h1><span class="prefix"></span><a class="title" href="#_query_value_percent_translations"><span class="text.normal">_query_value_percent_translations</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">_query_value_percent_translations = _mktrans("%&#38;#")
</code></pre></section><section class="data" documented="false" local-identifier="Parts" id="Parts"><h1><span class="prefix"></span><a class="title" href="#Parts"><span class="text.normal">Parts</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">Parts = collections.namedtuple("Parts",
	('type', 'scheme', 'netloc', 'path', 'query', 'fragment')
)
</code></pre></section><section class="function" documented="true" local-identifier="split" id="split"><h1><span class="prefix"></span><a class="title" href="#split"><span class="text.normal">split</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">split(iri)</code></p><p><span class="text.normal">Split an IRI into its base components based on the markers:</span></p><p><span class="text.normal">(: | ://), /, ?, #</span></p><p><span class="text.normal">Returns the top-level parts of the IRI as a namedtuple.</span></p><section class="unspecified" documented="true" local-identifier="Parameters" id="split.Parameters"><h1 class="integrate"><span class="prefix"></span><a class="section" href="#split">split</a><a class="title" href="#split.Parameters"><span class="text.normal">Parameters</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type"></span></div></h1><dl class="text.mapping"><div id="split.Parameters.iri" class="parameter" documented="true"><dt><a class="dkn" href="#split.Parameters.iri"></a><span class="directory-key"><code class="parameter">iri</code></span></dt><dd><div class="status"></div><p><span class="text.normal">A complete IRI or URI.</span></p></dd></div><div id="split.Parameters._scheme_char_set" class="parameter" documented="false"><dt><a class="dkn" href="#split.Parameters._scheme_char_set"></a><span class="directory-key"><code class="parameter">_scheme_char_set</code></span></dt><dd><div class="status"></div><p><code class="control.absent">Undocumented</code><span class="text.normal">.</span></p></dd></div></dl></section></section><section class="function" documented="true" local-identifier="join_path" id="join_path"><h1><span class="prefix"></span><a class="title" href="#join_path"><span class="text.normal">join_path</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">join_path(p)</code></p><p><span class="text.normal">Join a list of paths(strings) on "/" </span><span class="text.emphasis">after</span><span class="text.normal"> escaping them.</span></p></section><section class="data" documented="false" local-identifier="unsplit_path" id="unsplit_path"><h1><span class="prefix"></span><a class="title" href="#unsplit_path"><span class="text.normal">unsplit_path</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">unsplit_path = join_path
</code></pre></section><section class="function" documented="true" local-identifier="split_path" id="split_path"><h1><span class="prefix"></span><a class="title" href="#split_path"><span class="text.normal">split_path</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">split_path(p)</code></p><p><span class="text.normal">Return a list of unescaped strings split on "/".</span></p><p><span class="text.normal">Set </span><code class="">fieldproc</code><span class="text.normal"> to </span><code class="">str</code><span class="text.normal"> if the components' percent escapes should not be</span><span class="text.line-break"> </span><span class="text.normal">decoded.</span></p></section><section class="function" documented="true" local-identifier="join" id="join"><h1><span class="prefix"></span><a class="title" href="#join"><span class="text.normal">join</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">join(t)</code></p><p><span class="text.normal">Make an RI from a split RI(5-tuple)</span></p></section><section class="data" documented="false" local-identifier="unsplit" id="unsplit"><h1><span class="prefix"></span><a class="title" href="#unsplit"><span class="text.normal">unsplit</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">unsplit = join
</code></pre></section><section class="function" documented="true" local-identifier="remap_ipv4_address" id="remap_ipv4_address"><h1><span class="prefix"></span><a class="title" href="#remap_ipv4_address"><span class="text.normal">remap_ipv4_address</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">remap_ipv4_address(string)</code></p><p><span class="text.normal">Recognize IPv4 hosts as addresses.</span></p></section><section class="function" documented="true" local-identifier="split_netloc" id="split_netloc"><h1><span class="prefix"></span><a class="title" href="#split_netloc"><span class="text.normal">split_netloc</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">split_netloc(netloc)</code></p><p><span class="text.normal">Split a network location into a 4-tuple, (user, password, host, port).</span></p><p><span class="text.normal">Set </span><code class="">fieldproc</code><span class="text.normal"> to </span><code class="">str</code><span class="text.normal"> if the components' percent escapes should not be</span><span class="text.line-break"> </span><span class="text.normal">decoded.</span></p></section><section class="function" documented="true" local-identifier="join_netloc" id="join_netloc"><h1><span class="prefix"></span><a class="title" href="#join_netloc"><span class="text.normal">join_netloc</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">join_netloc(t)</code></p><p><span class="text.normal">Create a netloc fragment from the given tuple(user, password, host, address, port).</span></p></section><section class="data" documented="false" local-identifier="unsplit_netloc" id="unsplit_netloc"><h1><span class="prefix"></span><a class="title" href="#unsplit_netloc"><span class="text.normal">unsplit_netloc</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">unsplit_netloc = join_netloc
</code></pre></section><section class="function" documented="false" local-identifier="parse_query" id="parse_query"><h1><span class="prefix"></span><a class="title" href="#parse_query"><span class="text.normal">parse_query</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">parse_query(query)</code></p></section><section class="function" documented="true" local-identifier="structure" id="structure"><h1><span class="prefix"></span><a class="title" href="#structure"><span class="text.normal">structure</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">structure(t)</code></p><p><span class="text.normal">Create a dictionary from a split RI(5-tuple).</span></p><p><span class="text.normal">Set </span><code class="">fieldproc</code><span class="text.normal"> to </span><code class="">str</code><span class="text.normal"> if the components' percent escapes should not be</span><span class="text.line-break"> </span><span class="text.normal">decoded.</span></p></section><section class="function" documented="true" local-identifier="construct_query" id="construct_query"><h1><span class="prefix"></span><a class="title" href="#construct_query"><span class="text.normal">construct_query</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">construct_query(x)</code></p><p><span class="text.normal">Given a sequence of (key, value) pairs, construct.</span></p></section><section class="function" documented="true" local-identifier="construct" id="construct"><h1><span class="prefix"></span><a class="title" href="#construct"><span class="text.normal">construct</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">construct(x)</code></p><p><span class="text.normal">Construct a RI tuple(5-tuple) from a dictionary object.</span></p></section><section class="function" documented="true" local-identifier="parse" id="parse"><h1><span class="prefix"></span><a class="title" href="#parse"><span class="text.normal">parse</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">parse(iri)</code></p><p><span class="text.normal">Parse an RI into a dictionary object. Synonym for </span><code class="">structure(split(x))</code><span class="text.normal">.</span></p><p><span class="text.normal">Set </span><code class="">fieldproc</code><span class="text.normal"> to </span><code class="">str</code><span class="text.normal"> if the components' percent escapes should not be</span><span class="text.line-break"> </span><span class="text.normal">decoded.</span></p></section><section class="function" documented="true" local-identifier="serialize" id="serialize"><h1><span class="prefix"></span><a class="title" href="#serialize"><span class="text.normal">serialize</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">serialize(x)</code></p><p><span class="text.normal">Return an RI from a dictionary object. Synonym for </span><code class="">join(construct(x))</code><span class="text.normal">.</span></p></section><section class="function" documented="true" local-identifier="http" id="http"><h1><span class="prefix"></span><a class="title" href="#http"><span class="text.normal">http</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">http(struct)</code></p><p><span class="text.normal">Return the HTTP Request-URI suitable for submission with an HTTP request.</span></p></section><section class="function" documented="true" local-identifier="context_tokens" id="context_tokens"><h1><span class="prefix"></span><a class="title" href="#context_tokens"><span class="text.normal">context_tokens</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">context_tokens(scheme, type, user, password, host, address, port)</code></p><p><span class="text.normal">Format the authority fields of a Resource Indicator.</span></p></section><section class="function" documented="false" local-identifier="query_tokens" id="query_tokens"><h1><span class="prefix"></span><a class="title" href="#query_tokens"><span class="text.normal">query_tokens</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">query_tokens(query)</code></p></section><section class="function" documented="false" local-identifier="fragment_tokens" id="fragment_tokens"><h1><span class="prefix"></span><a class="title" href="#fragment_tokens"><span class="text.normal">fragment_tokens</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">fragment_tokens(fragment)</code></p></section><section class="function" documented="false" local-identifier="path_tokens" id="path_tokens"><h1><span class="prefix"></span><a class="title" href="#path_tokens"><span class="text.normal">path_tokens</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">path_tokens(root, path)</code></p></section><section class="function" documented="true" local-identifier="tokens" id="tokens"><h1><span class="prefix"></span><a class="title" href="#tokens"><span class="text.normal">tokens</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">tokens(struct)</code></p><p><span class="text.normal">Construct an iterator producing Resource Indicator Tokens.</span><span class="text.line-break"> </span><span class="text.normal">The items are pairs providing the type and the exact text</span><span class="text.line-break"> </span><span class="text.normal">to be used to reconstruct the Resource Indicator parsed</span><span class="text.line-break"> </span><span class="text.normal">into the given </span><a class="factor-local" href="#tokens.Parameters.struct"><span class="parameter">struct</span></a><span class="text.normal">.</span></p></section><h1 class="footing"></h1></main></body></html>