<html root="2"><head><title>fault.internet.media</title><meta charset="utf-8"/><link as="style" rel="preload" href="../../.legacy-web/core.css"></link><link as="style" rel="preload" href="../../.legacy-web/factor.css"></link><link rel="stylesheet" href="../../.legacy-web/core.css"></link><link rel="stylesheet" href="../../.legacy-web/factor.css"></link></head><body><main><h1><span class="prefix"></span><div class="page-subject"><img class="icon" src="../../.factor-type-icon/if.fault.io/python-module.svg"></img><span class="subject-identifier">media</span><span class="element-status"><span class="nothing-missed">0</span></span><a href="http://if.fault.io/factors/python.module"><code class="type">python.module</code></a></div><div class="page-context"><a href="../"><img class="icon" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNTYiIGhlaWdodD0iMjU2Ij48dGV4dCB4PSI0IiB5PSIwLjg4ZW0iIGZvbnQtc2l6ZT0iMjQ4Ij7wn5OhPC90ZXh0Pjwvc3ZnPg=="></img></a><span class="context-identifier">fault.internet</span></div></h1><section class="chapter"><p><span class="text.normal">Mime Type structures and parsers for content types and media ranges.</span></p><p><span class="text.normal">Interfaces here work exclusively with character-strings; wire data must be decoded.</span></p></section><section class="unspecified" documented="true" local-identifier="References" id="References"><h1><span class="prefix"></span><a class="title" href="#References"><span class="text.normal">References</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type"></span></div></h1><ul class="text.set"><li><p><a class="absolute" href="http://tools.ietf.org/html/rfc6838">http://tools.ietf.org/html/rfc6838</a></p></li></ul></section><section class="unspecified" documented="true" local-identifier="Properties" id="Properties"><h1><span class="prefix"></span><a class="title" href="#Properties"><span class="text.normal">Properties</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type"></span></div></h1><dl class="text.mapping"><div id="Properties.types" documented="true"><dt><a class="dkn" href="#Properties.types"></a><span class="directory-key"><span class="text.normal">types</span></span></dt><dd><div class="status"></div><p><span class="text.normal">A mapping of type names and file extensions to MIME type strings.</span></p></dd></div><div id="Properties.filename_extensions" documented="true"><dt><a class="dkn" href="#Properties.filename_extensions"></a><span class="directory-key"><span class="text.normal">filename_extensions</span></span></dt><dd><div class="status"></div><p><span class="text.normal">A mapping of filename extensions to type name.</span></p></dd></div><div id="Properties.iana_registered_types" documented="true"><dt><a class="dkn" href="#Properties.iana_registered_types"></a><span class="directory-key"><span class="text.normal">iana_registered_types</span></span></dt><dd><div class="status"></div><p><span class="text.normal">The IRI of the set of media types registered with IANA.</span></p></dd></div></dl></section><section class="unspecified" documented="true" local-identifier="Functions" id="Functions"><h1><span class="prefix"></span><a class="title" href="#Functions"><span class="text.normal">Functions</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type"></span></div></h1><dl class="text.mapping"><div id="Functions.type_from_string" documented="true"><dt><a class="dkn" href="#Functions.type_from_string"></a><span class="directory-key"><span class="text.normal">type_from_string</span></span></dt><dd><div class="status"></div><p><span class="text.normal">Construct a </span><a class="factor-local" href="#Type"><span class="class">Type</span></a><span class="text.normal"> instance from a MIME type string.</span></p><p><span class="text.normal">Code:</span></p><pre class="text.syntax"><code class="/pl/python">from fault.internet import media
mt = media.type_from_string("text/xml")
</code></pre><p><span class="text.normal">Equivalent to </span><a class="factor-local" href="#Type.from_string"><span class="classmethod">Type.from_string</span></a><span class="text.normal">, but cached.</span></p></dd></div><div id="Functions.range_from_string" documented="true"><dt><a class="dkn" href="#Functions.range_from_string"></a><span class="directory-key"><span class="text.normal">range_from_string</span></span></dt><dd><div class="status"></div><p><span class="text.normal">Construct a </span><a class="factor-local" href="#Range"><span class="class">Range</span></a><span class="text.normal"> instance from a Media Range string like an Accept header.</span></p><p><span class="text.normal">Equivalent to </span><a class="factor-local" href="#Range.from_string"><span class="classmethod">Range.from_string</span></a><span class="text.normal">, but cached.</span></p></dd></div></dl></section><section class="import" documented="false" local-identifier="operator" id="operator"><h1><span class="prefix"></span><a class="title" href="#operator"><span class="text.normal">operator</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">import</span></div></h1></section><section class="import" documented="false" local-identifier="functools" id="functools"><h1><span class="prefix"></span><a class="title" href="#functools"><span class="text.normal">functools</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">import</span></div></h1></section><section class="import" documented="false" local-identifier="typing" id="typing"><h1><span class="prefix"></span><a class="title" href="#typing"><span class="text.normal">typing</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">import</span></div></h1></section><section class="import" documented="false" local-identifier="tools" id="tools"><h1><span class="prefix"></span><a class="title" href="#tools"><span class="text.normal">tools</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">import</span></div></h1></section><section class="data" documented="false" local-identifier="iana_registered_types" id="iana_registered_types"><h1><span class="prefix"></span><a class="title" href="#iana_registered_types"><span class="text.normal">iana_registered_types</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">iana_registered_types = 'https://www.iana.org/assignments/media-types/media-types.xml'
</code></pre></section><section class="data" documented="false" local-identifier="types" id="types"><h1><span class="prefix"></span><a class="title" href="#types"><span class="text.normal">types</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">types = {
	'data': 'application/octet-stream', # browsers interpret this as a file download
	'fail': 'application/failure+xml',

	'python-pickle': 'application/x-python-object+pickle',
	'python-marshal': 'application/x-python-object+marshal',
	'python-xml': 'application/x-python-object+xml', # fault.xml format
	# 'structures': 'application/x-conceptual+xml',

	'text': 'text/plain',
	'txt': 'text/plain',
	'rtf': 'application/rtf',

	'cache': 'text/cache-manifest',
	'html': 'text/html',
	'htm': 'text/html',
	'css': 'text/css',

	'pdf': 'application/pdf',
	'postscript': 'application/postscript',

	'javascript': 'text/plain;pl=javascript',
	'py': 'text/plain;pl=python',

	# Recommended types for .js files.
	'json': 'application/json',
	'js': 'application/javascript',

	'xml': 'text/xml',
	'sgml': 'text/sgml',

	'rdf': 'application/rdf+xml',
	'rss': 'application/rss+xml',
	'atom': 'application/atom+xml',
	'xslt': 'application/xslt+xml',
	'xsl': 'application/xslt+xml',

	'zip': 'application/zip',
	'gzip': 'application/gzip',
	'gz': 'application/gzip',
	'bzip2': 'application/x-bzip2',
	'tar': 'application/x-tar',
	'xz': 'application/x-xz',
	'rar': 'application/x-rar-compressed',
	'sit': 'application/x-stuffit',
	'z': 'application/x-compress',

	'tgz': 'application/x-tar+gzip',
	'txz': 'application/x-tar+x-xz',
	'torrent': 'application/x-bittorrent',

	# images
	'svg': 'image/svg+xml',
	'png': 'image/png',
	'gif': 'image/gif',
	'tiff': 'image/tiff',
	'tif': 'image/tiff',
	'jpeg': 'image/jpeg',
	'jpg': 'image/jpeg',

	# video
	'mpg': 'video/mpeg',
	'mpeg': 'video/mpeg',
	'mp2': 'video/mpeg',
	'mov': 'video/quicktime',
	'mp4': 'video/mp4',
	'webm': 'video/webm',
	'ogv': 'video/ogg',
	'avi': 'video/avi',

	# audio
	'mp3': 'audio/mpeg',
	'mid': 'audio/midi',
	'wav': 'audio/x-wav',
	'aif': 'audio/x-aiff',
	'aiff': 'audio/x-aiff',

	'ogg': 'audio/ogg',
	'opus': 'audio/ogg',
	'oga': 'audio/ogg',
	'ogx': 'application/ogg',
	'spx': 'audio/ogg',

	# microsoft
	'xls': 'application/vnd.ms-excel',
	'doc': 'application/msword',
	'xlsx': 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
	'docx': 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
	'pptx': 'application/vnd.openxmlformats-officedocument.presentationml.presentation',
	'ppsx': 'application/vnd.openxmlformats-officedocument.presentationml.slideshow',
	'potx': 'application/vnd.openxmlformats-officedocument.presentationml.template',
}

@functools.lru_cache(32)
</code></pre></section><section class="function" documented="true" local-identifier="file_type" id="file_type"><h1><span class="prefix"></span><a class="title" href="#file_type"><span class="text.normal">file_type</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">file_type(filename)</code></p><p><span class="text.normal">Identify the MIME type from a filename using common file extensions.</span></p><p><span class="text.normal">Unidentified extensions will likely return application/octets-stream.</span></p></section><section class="class" documented="true" local-identifier="Type" id="Type"><h1><span class="prefix"></span><a class="title" href="#Type"><span class="text.normal">Type</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">class</span></div></h1><div class="inheritance"><code class="type"><a class="invalid" href="#tuple"><span class="unknown">tuple</span></a></code></div><p><span class="text.normal">An IANA Media Type; the Content-Type, Subtype, and options triple describing</span><span class="text.line-break"> </span><span class="text.normal">the type of data.</span></p><p><span class="text.normal">A container interface (</span><code class="">in</code><span class="text.normal">) is provided in order to identify if a given</span><span class="text.line-break"> </span><span class="text.normal">type is considered to be within another:</span></p><ul class="text.set"><li><p><code class="">text/html in */*</code></p></li><li><p><code class="">text/html in text/*</code></p></li><li><p><code class="">text/html;level=1 in text/html</code></p></li><li><p><code class="">text/html not in text/html;level=1</code></p></li></ul><p><span class="text.normal">The </span><a class="factor-local" href="#Type.from_string"><span class="classmethod">from_string</span></a><span class="text.normal"> classmethod is the common constructor.</span></p><section class="data" documented="false" local-identifier="__slots__" id="Type.__slots__"><h1><span class="prefix"></span><a class="section" href="#Type">Type</a><a class="title" href="#Type.__slots__"><span class="text.normal">__slots__</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">__slots__ = ()
</code></pre></section><section class="method" documented="false" local-identifier="__str__" id="Type.__str__"><h1><span class="prefix"></span><a class="section" href="#Type">Type</a><a class="title" href="#Type.__str__"><span class="text.normal">__str__</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">__str__(self)</code></p></section><section class="method" documented="false" local-identifier="__bytes__" id="Type.__bytes__"><h1><span class="prefix"></span><a class="section" href="#Type">Type</a><a class="title" href="#Type.__bytes__"><span class="text.normal">__bytes__</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">__bytes__(self)</code></p></section><section class="property" documented="true" local-identifier="cotype" id="Type.cotype"><h1><span class="prefix"></span><a class="section" href="#Type">Type</a><a class="title" href="#Type.cotype"><span class="text.normal">cotype</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">property</span></div></h1><p><span class="text.normal">Content Type; usually one of:</span></p><ul class="text.set"><li><p><code class="">application</code></p></li><li><p><code class="">text</code></p></li><li><p><code class="">image</code></p></li><li><p><code class="">video</code></p></li><li><p><code class="">model</code></p></li></ul><p><span class="text.normal">The initial part of a MIME (media) type.</span></p></section><section class="property" documented="true" local-identifier="subtype" id="Type.subtype"><h1><span class="prefix"></span><a class="section" href="#Type">Type</a><a class="title" href="#Type.subtype"><span class="text.normal">subtype</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">property</span></div></h1><p><span class="text.normal">Subtype; the specific form of the </span><a class="factor-local" href="#Type.cotype"><span class="property">cotype</span></a><span class="text.normal">.</span></p></section><section class="property" documented="true" local-identifier="parameters" id="Type.parameters"><h1><span class="prefix"></span><a class="section" href="#Type">Type</a><a class="title" href="#Type.parameters"><span class="text.normal">parameters</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">property</span></div></h1><p><span class="text.normal">Parameters such as charset for encoding designation.</span></p></section><section class="property" documented="true" local-identifier="pattern" id="Type.pattern"><h1><span class="prefix"></span><a class="section" href="#Type">Type</a><a class="title" href="#Type.pattern"><span class="text.normal">pattern</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">property</span></div><code class="type"><a class="invalid" href="#bool"><span class="unknown">bool</span></a></code></h1><p><span class="text.normal">Whether the </span><a class="factor-local" href="#Type"><span class="class">Type</span></a><span class="text.normal"> is a pattern and can match multiple types.</span></p></section><section class="method" documented="true" local-identifier="push" id="Type.push"><h1><span class="prefix"></span><a class="section" href="#Type">Type</a><a class="title" href="#Type.push"><span class="text.normal">push</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">push(self, subtype)</code></p><p><span class="text.normal">Return a new </span><a class="factor-local" href="#Type"><span class="class">Type</span></a><span class="text.normal"> with the given </span><a class="factor-local" href="#Type.push.Parameters.subtype"><span class="parameter">subtype</span></a><span class="text.normal"> appended to the instance's </span><a class="project-local" href="../subtype"><span class="unknown">subtype</span></a><span class="text.normal">.</span></p></section><section class="method" documented="true" local-identifier="pop" id="Type.pop"><h1><span class="prefix"></span><a class="section" href="#Type">Type</a><a class="title" href="#Type.pop"><span class="text.normal">pop</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">pop(self)</code></p><p><span class="text.normal">Return a new </span><a class="factor-local" href="#Type"><span class="class">Type</span></a><span class="text.normal"> with the last '+'-delimited subtype removed. (inverse of push).</span></p></section><section class="classmethod" documented="true" local-identifier="from_bytes" id="Type.from_bytes"><h1><span class="prefix"></span><a class="section" href="#Type">Type</a><a class="title" href="#Type.from_bytes"><span class="text.normal">from_bytes</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">classmethod</span></div></h1><p><code class="signature">from_bytes(Class, string, **parameters)</code></p><p><span class="text.normal">Split on the ';' and '/' separators and build an instance.</span></p><p><span class="text.normal">Additional parameters or overrides may be given using keywords.</span></p></section><section class="classmethod" documented="true" local-identifier="from_string" id="Type.from_string"><h1><span class="prefix"></span><a class="section" href="#Type">Type</a><a class="title" href="#Type.from_string"><span class="text.normal">from_string</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">classmethod</span></div></h1><p><code class="signature">from_string(Class, string, **parameters)</code></p><p><span class="text.normal">Split on the ';' and '/' separators and build an instance.</span></p><p><span class="text.normal">Additional parameters or overrides may be given using keywords.</span></p></section><section class="method" documented="false" local-identifier="__contains__" id="Type.__contains__"><h1><span class="prefix"></span><a class="section" href="#Type">Type</a><a class="title" href="#Type.__contains__"><span class="text.normal">__contains__</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">__contains__(self, mtype)</code></p></section></section><section class="class" documented="true" local-identifier="Range" id="Range"><h1><span class="prefix"></span><a class="title" href="#Range"><span class="text.normal">Range</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">class</span></div></h1><div class="inheritance"><code class="type"><a class="invalid" href="#tuple"><span class="unknown">tuple</span></a></code></div><p><span class="text.normal">Media Range class for supporting Accept headers.</span></p><p><span class="text.normal">Ranges are a mapping of content-types to an ordered sequence of subtype sets.</span><span class="text.line-break"> </span><span class="text.normal">The ordering of the subtype sets indicates the relative quality.</span></p><p><span class="text.normal">Querying the range for a set of types will return the types with the</span><span class="text.line-break"> </span><span class="text.normal">highest precedence for each content type.</span></p><p><a class="invalid" href="#None"><span class="unknown">None</span></a><span class="text.normal"> is used to represent any types, </span><code class="text">*</code><span class="text.normal">.</span></p><section class="data" documented="false" local-identifier="__slots__" id="Range.__slots__"><h1><span class="prefix"></span><a class="section" href="#Range">Range</a><a class="title" href="#Range.__slots__"><span class="text.normal">__slots__</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">__slots__ = ()
	@staticmethod
</code></pre></section><section class="staticmethod" documented="true" local-identifier="split" id="Range.split"><h1><span class="prefix"></span><a class="section" href="#Range">Range</a><a class="title" href="#Range.split"><span class="text.normal">split</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">staticmethod</span></div></h1><p><code class="signature">split(media_range)</code></p><p><span class="text.normal">Construct triples describing the </span><a class="factor-local" href="#Range.split.Parameters.media_range"><span class="parameter">media_range</span></a><span class="text.normal">.</span></p></section><section class="classmethod" documented="true" local-identifier="from_string" id="Range.from_string"><h1><span class="prefix"></span><a class="section" href="#Range">Range</a><a class="title" href="#Range.from_string"><span class="text.normal">from_string</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">classmethod</span></div></h1><p><code class="signature">from_string(Class, string)</code></p><p><span class="text.normal">Instantiate the Range from a string.</span></p></section><section class="classmethod" documented="true" local-identifier="from_bytes" id="Range.from_bytes"><h1><span class="prefix"></span><a class="section" href="#Range">Range</a><a class="title" href="#Range.from_bytes"><span class="text.normal">from_bytes</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">classmethod</span></div></h1><p><code class="signature">from_bytes(Class, data)</code></p><p><span class="text.normal">Instantiate the Range from a bytes object; decoded and passed to </span><a class="factor-local" href="#Range.from_string"><span class="classmethod">from_string</span></a><span class="text.normal">.</span></p></section><section class="method" documented="true" local-identifier="quality" id="Range.quality"><h1><span class="prefix"></span><a class="section" href="#Range">Range</a><a class="title" href="#Range.quality"><span class="text.normal">quality</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">quality(self, mimetype)</code></p><p><span class="text.normal">Search for a single MIME type in the range.</span><span class="text.line-break"> </span><span class="text.normal">Return identified quality of the type.</span></p><p><span class="text.normal">The quality of a particular type is useful in cases where the</span><span class="text.line-break"> </span><span class="text.normal">server wants to give some precedence to another type.</span><span class="text.line-break"> </span><span class="text.normal">Given that the client accepts XML, but it is a lower quality than HTML,</span><span class="text.line-break"> </span><span class="text.normal">the server may want to send XML anyways.</span></p></section><section class="method" documented="true" local-identifier="query" id="Range.query"><h1><span class="prefix"></span><a class="section" href="#Range">Range</a><a class="title" href="#Range.query"><span class="text.normal">query</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">query(self, *available)</code></p><p><span class="text.normal">Given a sequence of mime types, return the best match</span><span class="text.line-break"> </span><span class="text.normal">according to the qualities recorded in the range.</span></p></section></section><section class="data" documented="false" local-identifier="any_type" id="any_type"><h1><span class="prefix"></span><a class="title" href="#any_type"><span class="text.normal">any_type</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">any_type = Type(('*', '*', frozenset()))
</code></pre></section><section class="data" documented="false" local-identifier="any_range" id="any_range"><h1><span class="prefix"></span><a class="title" href="#any_range"><span class="text.normal">any_range</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">any_range = Range([(100, any_type)])
</code></pre></section><section class="data" documented="false" local-identifier="type_from_bytes" id="type_from_bytes"><h1><span class="prefix"></span><a class="title" href="#type_from_bytes"><span class="text.normal">type_from_bytes</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">type_from_bytes = functools.lru_cache(32)(Type.from_bytes)
</code></pre></section><section class="data" documented="false" local-identifier="type_from_string" id="type_from_string"><h1><span class="prefix"></span><a class="title" href="#type_from_string"><span class="text.normal">type_from_string</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">type_from_string = functools.lru_cache(32)(Type.from_string)
</code></pre></section><section class="data" documented="false" local-identifier="range_from_string" id="range_from_string"><h1><span class="prefix"></span><a class="title" href="#range_from_string"><span class="text.normal">range_from_string</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">range_from_string = functools.lru_cache(32)(Range.from_string)
</code></pre></section><h1 class="footing"></h1></main></body></html>