<html root="2"><head><title>fault.syntax.delta</title><meta charset="utf-8"/><link as="style" rel="preload" href="../../.legacy-web/core.css"></link><link as="style" rel="preload" href="../../.legacy-web/factor.css"></link><link rel="stylesheet" href="../../.legacy-web/core.css"></link><link rel="stylesheet" href="../../.legacy-web/factor.css"></link></head><body><main><h1><span class="prefix"></span><div class="page-subject"><img class="icon" src="../../.factor-type-icon/if.fault.io/python-module.svg"></img><span class="subject-identifier">delta</span><span class="element-status"><span class="nothing-missed">0</span></span><a href="http://if.fault.io/factors/python.module"><code class="type">python.module</code></a></div><div class="page-context"><a href="../"><img class="icon" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNTYiIGhlaWdodD0iMjU2Ij48dGV4dCB4PSI0IiB5PSIwLjg4ZW0iIGZvbnQtc2l6ZT0iMjQ4Ij7wn5OEPC90ZXh0Pjwvc3ZnPg=="></img></a><span class="context-identifier">fault.syntax</span></div></h1><section class="chapter"><p><span class="text.normal">Element change logs for managing deltas, undo, and redo.</span></p></section><section class="import" documented="false" local-identifier="itertools" id="itertools"><h1><span class="prefix"></span><a class="title" href="#itertools"><span class="text.normal">itertools</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">import</span></div></h1></section><section class="import" documented="false" local-identifier="Protocol" id="Protocol"><h1><span class="prefix"></span><a class="title" href="#Protocol"><span class="text.normal">Protocol</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">import</span></div></h1></section><section class="import" documented="false" local-identifier="struct" id="struct"><h1><span class="prefix"></span><a class="title" href="#struct"><span class="text.normal">struct</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">import</span></div></h1></section><section class="class" documented="true" local-identifier="Summary" id="Summary"><h1><span class="prefix"></span><a class="title" href="#Summary"><span class="text.normal">Summary</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">class</span></div></h1><div class="inheritance"><code class="type"><a class="none" href="http://fault.io/dev/null"><span class="invalid">Protocol</span></a></code></div><p><span class="text.normal">Interface for communicating changes to lines and codepoints.</span></p><p><span class="text.normal">Used by </span><a class="factor-local" href="#Log.track"><span class="method">Log.track</span></a><span class="text.normal"> to communicate change summaries for cursor motion</span><span class="text.line-break"> </span><span class="text.normal">and view stabilization.</span></p><section class="unspecified" documented="true" local-identifier="Engineering" id="Summary.Engineering"><h1 class="integrate"><span class="prefix"></span><a class="section" href="#Summary">Summary</a><a class="title" href="#Summary.Engineering"><span class="text.normal">Engineering</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type"></span></div></h1><p><span class="text.normal">Implementing this using an abstraction that received changes the same way</span><span class="text.line-break"> </span><span class="text.normal">that a log's storage target does was not entirely trivial. Line deltas</span><span class="text.line-break"> </span><span class="text.normal">could be easily summarized, but reconstructing the codepoint deltas from</span><span class="text.line-break"> </span><a class="factor-local" href="#Update"><span class="class">Update.apply's</span></a><span class="text.normal"> usage required multiple levels of reconstruction.</span></p><p><span class="text.normal">Creating an explicit protocol is somewhat undiresable, but using an abstraction</span><span class="text.line-break"> </span><span class="text.normal">that required such tight coupling to </span><a class="factor-local" href="#Update"><span class="class">Update.apply's</span></a><span class="text.normal"> implementation appeared</span><span class="text.line-break"> </span><span class="text.normal">inferior. Additionally, this provides a relevant location for checkpoint or</span><span class="text.line-break"> </span><span class="text.normal">commit reporting given the need.</span></p></section><section class="method" documented="true" local-identifier="line_delta" id="Summary.line_delta"><h1><span class="prefix"></span><a class="section" href="#Summary">Summary</a><a class="title" href="#Summary.line_delta"><span class="text.normal">line_delta</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">line_delta(self, ln_offset, deleted, inserted)</code></p><p><span class="text.normal">Report that lines were </span><a class="factor-local" href="#Summary.line_delta.Parameters.deleted"><span class="parameter">deleted</span></a><span class="text.normal"> and </span><a class="factor-local" href="#Summary.line_delta.Parameters.inserted"><span class="parameter">inserted</span></a><span class="text.normal"> at </span><a class="factor-local" href="#Summary.line_delta.Parameters.ln_offset"><span class="parameter">ln_offset</span></a><span class="text.normal">.</span></p></section><section class="method" documented="true" local-identifier="codepoint_delta" id="Summary.codepoint_delta"><h1><span class="prefix"></span><a class="section" href="#Summary">Summary</a><a class="title" href="#Summary.codepoint_delta"><span class="text.normal">codepoint_delta</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">codepoint_delta(self, ln_offset, cp_offset, deleted, inserted)</code></p><p><span class="text.normal">Report that codepoints were </span><a class="factor-local" href="#Summary.codepoint_delta.Parameters.deleted"><span class="parameter">deleted</span></a><span class="text.normal"> and </span><a class="factor-local" href="#Summary.codepoint_delta.Parameters.inserted"><span class="parameter">inserted</span></a><span class="text.line-break"> </span><span class="text.normal">at </span><a class="factor-local" href="#Summary.codepoint_delta.Parameters.cp_offset"><span class="parameter">cp_offset</span></a><span class="text.normal"> in the line identified by </span><a class="factor-local" href="#Summary.codepoint_delta.Parameters.ln_offset"><span class="parameter">ln_offset</span></a><span class="text.normal">.</span></p></section></section><section class="class" documented="true" local-identifier="Record" id="Record"><h1><span class="prefix"></span><a class="title" href="#Record"><span class="text.normal">Record</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">class</span></div></h1><div class="inheritance"><code class="type"><a class="none" href="http://fault.io/dev/null"><span class="invalid">Protocol</span></a></code></div><p><span class="text.normal">An indvidial record of change.</span></p><section class="property" documented="true" local-identifier="span" id="Record.span"><h1><span class="prefix"></span><a class="section" href="#Record">Record</a><a class="title" href="#Record.span"><span class="text.normal">span</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">property</span></div></h1><p><span class="text.normal">The element offset and count of elements that were changed.</span></p></section><section class="property" documented="true" local-identifier="change" id="Record.change"><h1><span class="prefix"></span><a class="section" href="#Record">Record</a><a class="title" href="#Record.change"><span class="text.normal">change</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">property</span></div></h1><p><span class="text.normal">The change in the elements' length that occurred.</span><span class="text.line-break"> </span><span class="text.normal">Length of insertions minus length of deletions.</span></p></section><section class="method" documented="true" local-identifier="usage" id="Record.usage"><h1><span class="prefix"></span><a class="section" href="#Record">Record</a><a class="title" href="#Record.usage"><span class="text.normal">usage</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">usage(self)</code></p><p><span class="text.normal">Memory usage of the record. The given </span><a class="invalid" href="#count"><span class="unknown">count</span></a><span class="text.normal"> will</span><span class="text.line-break"> </span><span class="text.normal">measure an object's size if it hasn't already been seen.</span></p></section><section class="method" documented="true" local-identifier="size" id="Record.size"><h1><span class="prefix"></span><a class="section" href="#Record">Record</a><a class="title" href="#Record.size"><span class="text.normal">size</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">size(self, encoding)</code></p><p><span class="text.normal">Change in bytes of the target resource after the record is applied.</span></p></section><section class="method" documented="true" local-identifier="invert" id="Record.invert"><h1><span class="prefix"></span><a class="section" href="#Record">Record</a><a class="title" href="#Record.invert"><span class="text.normal">invert</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">invert(self)</code></p><p><span class="text.normal">Construct the version of the record that reverses the effect</span><span class="text.line-break"> </span><span class="text.normal">of the change.</span></p></section><section class="method" documented="true" local-identifier="revert" id="Record.revert"><h1><span class="prefix"></span><a class="section" href="#Record">Record</a><a class="title" href="#Record.revert"><span class="text.normal">revert</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">revert(self)</code></p><p><span class="text.normal">Reconstruct </span><a class="factor-local" href="#Record.revert.Parameters.self"><span class="parameter">self</span></a><span class="text.normal"> to perform an ineffective operation.</span></p></section><section class="method" documented="true" local-identifier="track" id="Record.track"><h1><span class="prefix"></span><a class="section" href="#Record">Record</a><a class="title" href="#Record.track"><span class="text.normal">track</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">track(self, target)</code></p><p><span class="text.normal">Communicate the change to </span><a class="factor-local" href="#Record.track.Parameters.target"><span class="parameter">target</span></a><span class="text.normal">.</span></p></section><section class="method" documented="true" local-identifier="apply" id="Record.apply"><h1><span class="prefix"></span><a class="section" href="#Record">Record</a><a class="title" href="#Record.apply"><span class="text.normal">apply</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">apply(self, target)</code></p><p><span class="text.normal">Perform the change to the given </span><a class="factor-local" href="#Record.apply.Parameters.target"><span class="parameter">target</span></a><span class="text.normal">.</span></p></section><section class="method" documented="true" local-identifier="retract" id="Record.retract"><h1><span class="prefix"></span><a class="section" href="#Record">Record</a><a class="title" href="#Record.retract"><span class="text.normal">retract</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">retract(self, target)</code></p><p><span class="text.normal">Perform the inverse, restoring the </span><a class="factor-local" href="#Record.retract.Parameters.target"><span class="parameter">target</span></a><span class="text.normal"> to the state that it was</span><span class="text.line-break"> </span><span class="text.normal">in prior to </span><a class="factor-local" href="#Record.apply"><span class="method">apply</span></a><span class="text.normal"> being performed.</span></p></section></section><section class="class" documented="true" local-identifier="Checkpoint" id="Checkpoint"><h1><span class="prefix"></span><a class="title" href="#Checkpoint"><span class="text.normal">Checkpoint</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">class</span></div></h1><div class="inheritance"><code class="type"><a class="factor-local" href="#Record"><span class="class">Record</span></a></code></div><p><span class="text.normal">A no-op change holding a creation timestamp.</span></p><p><span class="text.normal">Used to delimit </span><a class="factor-local" href="#Record"><span class="class">Record</span></a><span class="text.normal"> groups for </span><a class="factor-local" href="#Log.undo"><span class="method">Log.undo</span></a><span class="text.normal"> and </span><a class="factor-local" href="#Log.redo"><span class="method">Log.redo</span></a><span class="text.normal">.</span></p><section class="property" documented="false" local-identifier="change" id="Checkpoint.change"><h1><span class="prefix"></span><a class="section" href="#Checkpoint">Checkpoint</a><a class="title" href="#Checkpoint.change"><span class="text.normal">change</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">property</span></div></h1></section><section class="property" documented="false" local-identifier="span" id="Checkpoint.span"><h1><span class="prefix"></span><a class="section" href="#Checkpoint">Checkpoint</a><a class="title" href="#Checkpoint.span"><span class="text.normal">span</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">property</span></div></h1></section><section class="data" documented="false" local-identifier="element" id="Checkpoint.element"><h1><span class="prefix"></span><a class="section" href="#Checkpoint">Checkpoint</a><a class="title" href="#Checkpoint.element"><span class="text.normal">element</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">element = None
</code></pre></section><section class="data" documented="false" local-identifier="insertion" id="Checkpoint.insertion"><h1><span class="prefix"></span><a class="section" href="#Checkpoint">Checkpoint</a><a class="title" href="#Checkpoint.insertion"><span class="text.normal">insertion</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">insertion = None
</code></pre></section><section class="data" documented="false" local-identifier="deletion" id="Checkpoint.deletion"><h1><span class="prefix"></span><a class="section" href="#Checkpoint">Checkpoint</a><a class="title" href="#Checkpoint.deletion"><span class="text.normal">deletion</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">deletion = None
</code></pre></section><section class="method" documented="false" local-identifier="usage" id="Checkpoint.usage"><h1><span class="prefix"></span><a class="section" href="#Checkpoint">Checkpoint</a><a class="title" href="#Checkpoint.usage"><span class="text.normal">usage</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">usage(self)</code></p></section><section class="method" documented="false" local-identifier="invert" id="Checkpoint.invert"><h1><span class="prefix"></span><a class="section" href="#Checkpoint">Checkpoint</a><a class="title" href="#Checkpoint.invert"><span class="text.normal">invert</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">invert(self)</code></p></section><section class="method" documented="false" local-identifier="track" id="Checkpoint.track"><h1><span class="prefix"></span><a class="section" href="#Checkpoint">Checkpoint</a><a class="title" href="#Checkpoint.track"><span class="text.normal">track</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">track(self, target)</code></p></section><section class="method" documented="false" local-identifier="apply" id="Checkpoint.apply"><h1><span class="prefix"></span><a class="section" href="#Checkpoint">Checkpoint</a><a class="title" href="#Checkpoint.apply"><span class="text.normal">apply</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">apply(self, target)</code></p></section><section class="method" documented="false" local-identifier="retract" id="Checkpoint.retract"><h1><span class="prefix"></span><a class="section" href="#Checkpoint">Checkpoint</a><a class="title" href="#Checkpoint.retract"><span class="text.normal">retract</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">retract(self, target)</code></p></section><section class="method" documented="false" local-identifier="revert" id="Checkpoint.revert"><h1><span class="prefix"></span><a class="section" href="#Checkpoint">Checkpoint</a><a class="title" href="#Checkpoint.revert"><span class="text.normal">revert</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">revert(self)</code></p></section><section class="method" documented="false" local-identifier="combine" id="Checkpoint.combine"><h1><span class="prefix"></span><a class="section" href="#Checkpoint">Checkpoint</a><a class="title" href="#Checkpoint.combine"><span class="text.normal">combine</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">combine(self, following)</code></p></section></section><section class="class" documented="true" local-identifier="Update" id="Update"><h1><span class="prefix"></span><a class="title" href="#Update"><span class="text.normal">Update</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">class</span></div></h1><div class="inheritance"><code class="type"><a class="factor-local" href="#Record"><span class="class">Record</span></a></code></div><p><span class="text.normal">Individual record update.</span></p><section class="property" documented="true" local-identifier="change" id="Update.change"><h1><span class="prefix"></span><a class="section" href="#Update">Update</a><a class="title" href="#Update.change"><span class="text.normal">change</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">property</span></div></h1><p><span class="text.normal">Change in </span><span class="text.emphasis">elements</span><span class="text.normal">. Always zero for </span><a class="factor-local" href="#Update"><span class="class">Update</span></a><span class="text.normal">.</span></p></section><section class="property" documented="false" local-identifier="span" id="Update.span"><h1><span class="prefix"></span><a class="section" href="#Update">Update</a><a class="title" href="#Update.span"><span class="text.normal">span</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">property</span></div></h1></section><section class="method" documented="false" local-identifier="usage" id="Update.usage"><h1><span class="prefix"></span><a class="section" href="#Update">Update</a><a class="title" href="#Update.usage"><span class="text.normal">usage</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">usage(self)</code></p></section><section class="method" documented="false" local-identifier="size" id="Update.size"><h1><span class="prefix"></span><a class="section" href="#Update">Update</a><a class="title" href="#Update.size"><span class="text.normal">size</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">size(self, encoding)</code></p></section><section class="method" documented="true" local-identifier="invert" id="Update.invert"><h1><span class="prefix"></span><a class="section" href="#Update">Update</a><a class="title" href="#Update.invert"><span class="text.normal">invert</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">invert(self)</code></p><p><span class="text.normal">Recreate the record where insertion and deletion are swapped.</span></p></section><section class="method" documented="false" local-identifier="track" id="Update.track"><h1><span class="prefix"></span><a class="section" href="#Update">Update</a><a class="title" href="#Update.track"><span class="text.normal">track</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">track(self, target)</code></p></section><section class="method" documented="false" local-identifier="apply" id="Update.apply"><h1><span class="prefix"></span><a class="section" href="#Update">Update</a><a class="title" href="#Update.apply"><span class="text.normal">apply</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">apply(self, target)</code></p></section><section class="method" documented="false" local-identifier="retract" id="Update.retract"><h1><span class="prefix"></span><a class="section" href="#Update">Update</a><a class="title" href="#Update.retract"><span class="text.normal">retract</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">retract(self, target)</code></p></section><section class="method" documented="false" local-identifier="revert" id="Update.revert"><h1><span class="prefix"></span><a class="section" href="#Update">Update</a><a class="title" href="#Update.revert"><span class="text.normal">revert</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">revert(self)</code></p></section><section class="method" documented="true" local-identifier="combine" id="Update.combine"><h1><span class="prefix"></span><a class="section" href="#Update">Update</a><a class="title" href="#Update.combine"><span class="text.normal">combine</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">combine(self, following)</code></p><p><span class="text.normal">Construct a new </span><a class="factor-local" href="#Update"><span class="class">Update</span></a><span class="text.normal"> instance by combining </span><a class="factor-local" href="#Update.combine.Parameters.self"><span class="parameter">self</span></a><span class="text.normal"> with </span><a class="factor-local" href="#Update.combine.Parameters.following"><span class="parameter">following</span></a><span class="text.normal">.</span><span class="text.line-break"> </span><a class="invalid" href="#None"><span class="unknown">None</span></a><span class="text.normal"> when </span><a class="factor-local" href="#Update.combine.Parameters.following"><span class="parameter">following</span></a><span class="text.normal"> cannot be combined with </span><a class="factor-local" href="#Update.combine.Parameters.self"><span class="parameter">self</span></a><span class="text.normal">.</span></p></section></section><section class="class" documented="true" local-identifier="Lines" id="Lines"><h1><span class="prefix"></span><a class="title" href="#Lines"><span class="text.normal">Lines</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">class</span></div></h1><div class="inheritance"><code class="type"><a class="factor-local" href="#Record"><span class="class">Record</span></a></code></div><p><span class="text.normal">Insertion and/or deletion of zero or more elements.</span></p><section class="property" documented="false" local-identifier="change" id="Lines.change"><h1><span class="prefix"></span><a class="section" href="#Lines">Lines</a><a class="title" href="#Lines.change"><span class="text.normal">change</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">property</span></div></h1></section><section class="property" documented="false" local-identifier="span" id="Lines.span"><h1><span class="prefix"></span><a class="section" href="#Lines">Lines</a><a class="title" href="#Lines.span"><span class="text.normal">span</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">property</span></div></h1></section><section class="method" documented="false" local-identifier="usage" id="Lines.usage"><h1><span class="prefix"></span><a class="section" href="#Lines">Lines</a><a class="title" href="#Lines.usage"><span class="text.normal">usage</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">usage(self)</code></p></section><section class="method" documented="false" local-identifier="size" id="Lines.size"><h1><span class="prefix"></span><a class="section" href="#Lines">Lines</a><a class="title" href="#Lines.size"><span class="text.normal">size</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">size(self, encoding)</code></p></section><section class="method" documented="true" local-identifier="invert" id="Lines.invert"><h1><span class="prefix"></span><a class="section" href="#Lines">Lines</a><a class="title" href="#Lines.invert"><span class="text.normal">invert</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">invert(self)</code></p><p><span class="text.normal">Recreate the record where insertion and deletion are swapped.</span></p></section><section class="method" documented="false" local-identifier="track" id="Lines.track"><h1><span class="prefix"></span><a class="section" href="#Lines">Lines</a><a class="title" href="#Lines.track"><span class="text.normal">track</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">track(self, target)</code></p></section><section class="method" documented="false" local-identifier="apply" id="Lines.apply"><h1><span class="prefix"></span><a class="section" href="#Lines">Lines</a><a class="title" href="#Lines.apply"><span class="text.normal">apply</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">apply(self, target)</code></p></section><section class="method" documented="false" local-identifier="retract" id="Lines.retract"><h1><span class="prefix"></span><a class="section" href="#Lines">Lines</a><a class="title" href="#Lines.retract"><span class="text.normal">retract</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">retract(self, target)</code></p></section><section class="method" documented="false" local-identifier="revert" id="Lines.revert"><h1><span class="prefix"></span><a class="section" href="#Lines">Lines</a><a class="title" href="#Lines.revert"><span class="text.normal">revert</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">revert(self)</code></p></section><section class="method" documented="false" local-identifier="combine" id="Lines.combine"><h1><span class="prefix"></span><a class="section" href="#Lines">Lines</a><a class="title" href="#Lines.combine"><span class="text.normal">combine</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">combine(self, following)</code></p></section></section><section class="class" documented="true" local-identifier="Cursor" id="Cursor"><h1><span class="prefix"></span><a class="title" href="#Cursor"><span class="text.normal">Cursor</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">class</span></div></h1><div class="inheritance"><code class="type"><a class="factor-local" href="#Record"><span class="class">Record</span></a></code></div><p><span class="text.normal">Change</span></p><section class="property" documented="false" local-identifier="change" id="Cursor.change"><h1><span class="prefix"></span><a class="section" href="#Cursor">Cursor</a><a class="title" href="#Cursor.change"><span class="text.normal">change</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">property</span></div></h1></section><section class="property" documented="false" local-identifier="span" id="Cursor.span"><h1><span class="prefix"></span><a class="section" href="#Cursor">Cursor</a><a class="title" href="#Cursor.span"><span class="text.normal">span</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">property</span></div></h1></section><section class="method" documented="false" local-identifier="usage" id="Cursor.usage"><h1><span class="prefix"></span><a class="section" href="#Cursor">Cursor</a><a class="title" href="#Cursor.usage"><span class="text.normal">usage</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">usage(self)</code></p></section><section class="method" documented="false" local-identifier="size" id="Cursor.size"><h1><span class="prefix"></span><a class="section" href="#Cursor">Cursor</a><a class="title" href="#Cursor.size"><span class="text.normal">size</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">size(self, encoding)</code></p></section><section class="method" documented="true" local-identifier="invert" id="Cursor.invert"><h1><span class="prefix"></span><a class="section" href="#Cursor">Cursor</a><a class="title" href="#Cursor.invert"><span class="text.normal">invert</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">invert(self)</code></p><p><span class="text.normal">Recreate the record where insertion and deletion are swapped.</span></p></section><section class="method" documented="false" local-identifier="track" id="Cursor.track"><h1><span class="prefix"></span><a class="section" href="#Cursor">Cursor</a><a class="title" href="#Cursor.track"><span class="text.normal">track</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">track(self, target)</code></p></section><section class="method" documented="false" local-identifier="apply" id="Cursor.apply"><h1><span class="prefix"></span><a class="section" href="#Cursor">Cursor</a><a class="title" href="#Cursor.apply"><span class="text.normal">apply</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">apply(self, target)</code></p></section><section class="method" documented="false" local-identifier="retract" id="Cursor.retract"><h1><span class="prefix"></span><a class="section" href="#Cursor">Cursor</a><a class="title" href="#Cursor.retract"><span class="text.normal">retract</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">retract(self, target)</code></p></section><section class="method" documented="false" local-identifier="combine" id="Cursor.combine"><h1><span class="prefix"></span><a class="section" href="#Cursor">Cursor</a><a class="title" href="#Cursor.combine"><span class="text.normal">combine</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">combine(self, following)</code></p></section></section><section class="class" documented="true" local-identifier="Log" id="Log"><h1><span class="prefix"></span><a class="title" href="#Log"><span class="text.normal">Log</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">class</span></div></h1><div class="inheritance"><code class="type"><a class="invalid" href="#object"><span class="unknown">object</span></a></code></div><p><span class="text.normal">The </span><a class="factor-local" href="#Record"><span class="class">Record</span></a><span class="text.normal"> vector tracking the changes.</span></p><section class="method" documented="false" local-identifier="__init__" id="Log.__init__"><h1><span class="prefix"></span><a class="section" href="#Log">Log</a><a class="title" href="#Log.__init__"><span class="text.normal">__init__</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">__init__(self)</code></p></section><section class="method" documented="true" local-identifier="revert" id="Log.revert"><h1><span class="prefix"></span><a class="section" href="#Log">Log</a><a class="title" href="#Log.revert"><span class="text.normal">revert</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">revert(self, target)</code></p><p><span class="text.normal">Retract all committed changes on </span><a class="factor-local" href="#Log.revert.Parameters.target"><span class="parameter">target</span></a><span class="text.normal">.</span></p></section><section class="method" documented="false" local-identifier="truncate" id="Log.truncate"><h1><span class="prefix"></span><a class="section" href="#Log">Log</a><a class="title" href="#Log.truncate"><span class="text.normal">truncate</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">truncate(self)</code></p></section><section class="method" documented="true" local-identifier="size" id="Log.size"><h1><span class="prefix"></span><a class="section" href="#Log">Log</a><a class="title" href="#Log.size"><span class="text.normal">size</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">size(self, encoding)</code></p><p><span class="text.normal">Total size of the logged changes.</span></p></section><section class="method" documented="false" local-identifier="usage" id="Log.usage"><h1><span class="prefix"></span><a class="section" href="#Log">Log</a><a class="title" href="#Log.usage"><span class="text.normal">usage</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">usage(self)</code></p></section><section class="method" documented="true" local-identifier="snapshot" id="Log.snapshot"><h1><span class="prefix"></span><a class="section" href="#Log">Log</a><a class="title" href="#Log.snapshot"><span class="text.normal">snapshot</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">snapshot(self)</code></p><p><span class="text.normal">Construct a reference to the current version.</span></p></section><section class="method" documented="true" local-identifier="since" id="Log.since"><h1><span class="prefix"></span><a class="section" href="#Log">Log</a><a class="title" href="#Log.since"><span class="text.normal">since</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">since(self, snapshot)</code></p><p><span class="text.normal">Generate a sequence of changes since </span><a class="invalid" href="#version"><span class="unknown">version</span></a><span class="text.normal">.</span></p></section><section class="method" documented="true" local-identifier="write" id="Log.write"><h1><span class="prefix"></span><a class="section" href="#Log">Log</a><a class="title" href="#Log.write"><span class="text.normal">write</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">write(self, record)</code></p><p><span class="text.normal">Append a delta to the log.</span></p></section><section class="method" documented="true" local-identifier="pending" id="Log.pending"><h1><span class="prefix"></span><a class="section" href="#Log">Log</a><a class="title" href="#Log.pending"><span class="text.normal">pending</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">pending(self)</code></p><p><span class="text.normal">Return the uncommitted deltas.</span></p></section><section class="method" documented="true" local-identifier="track" id="Log.track"><h1><span class="prefix"></span><a class="section" href="#Log">Log</a><a class="title" href="#Log.track"><span class="text.normal">track</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">track(self, target)</code></p><p><span class="text.normal">Update </span><a class="factor-local" href="#Log.track.Parameters.target"><span class="parameter">target</span></a><span class="text.normal"> by reporting the change summaries.</span></p></section><section class="method" documented="true" local-identifier="apply" id="Log.apply"><h1><span class="prefix"></span><a class="section" href="#Log">Log</a><a class="title" href="#Log.apply"><span class="text.normal">apply</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">apply(self, target)</code></p><p><span class="text.normal">Update </span><a class="factor-local" href="#Log.apply.Parameters.target"><span class="parameter">target</span></a><span class="text.normal"> by applying the current transaction.</span></p></section><section class="method" documented="true" local-identifier="retract" id="Log.retract"><h1><span class="prefix"></span><a class="section" href="#Log">Log</a><a class="title" href="#Log.retract"><span class="text.normal">retract</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">retract(self, target)</code></p><p><span class="text.normal">Update </span><a class="factor-local" href="#Log.retract.Parameters.target"><span class="parameter">target</span></a><span class="text.normal"> by previously applied retracting records.</span></p></section><section class="method" documented="true" local-identifier="collapse" id="Log.collapse"><h1><span class="prefix"></span><a class="section" href="#Log">Log</a><a class="title" href="#Log.collapse"><span class="text.normal">collapse</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">collapse(self)</code></p><p><span class="text.normal">Commit the leading deltas of the current transaction</span><span class="text.line-break"> </span><span class="text.normal">by combining records.</span></p><p><span class="text.normal">Primarily intended to eliminate successive character insertions</span><span class="text.line-break"> </span><span class="text.normal">and deletions when typing in insert mode.</span></p></section><section class="method" documented="true" local-identifier="commit" id="Log.commit"><h1><span class="prefix"></span><a class="section" href="#Log">Log</a><a class="title" href="#Log.commit"><span class="text.normal">commit</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">commit(self)</code></p><p><span class="text.normal">Update the commit position.</span><span class="text.line-break"> </span><span class="text.normal">Normally called directly after </span><a class="factor-local" href="#Log.apply"><span class="method">apply</span></a><span class="text.normal">.</span></p></section><section class="method" documented="true" local-identifier="abort" id="Log.abort"><h1><span class="prefix"></span><a class="section" href="#Log">Log</a><a class="title" href="#Log.abort"><span class="text.normal">abort</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">abort(self)</code></p><p><span class="text.normal">Remove any records written since </span><a class="invalid" href="#committed"><span class="unknown">committed</span></a><span class="text.normal"> and update </span><a class="invalid" href="#count"><span class="unknown">count</span></a><span class="text.line-break"> </span><span class="text.normal">to reflect the new </span><a class="invalid" href="#records"><span class="unknown">records</span></a><span class="text.normal"> state.</span></p><p><span class="text.normal">Not normally used as deleting records will likely cause display inconsistencies.</span><span class="text.line-break"> </span><span class="text.normal">In most cases, </span><a class="factor-local" href="#Log.undo"><span class="method">undo</span></a><span class="text.normal"> should be used.</span></p></section><section class="method" documented="true" local-identifier="checkpoint" id="Log.checkpoint"><h1><span class="prefix"></span><a class="section" href="#Log">Log</a><a class="title" href="#Log.checkpoint"><span class="text.normal">checkpoint</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">checkpoint(self)</code></p><p><span class="text.normal">Write a checkpoint clearing any uncommitted writes.</span></p></section><section class="method" documented="true" local-identifier="undo" id="Log.undo"><h1><span class="prefix"></span><a class="section" href="#Log">Log</a><a class="title" href="#Log.undo"><span class="text.normal">undo</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">undo(self)</code></p><p><span class="text.normal">Retract delta records effecting </span><a class="invalid" href="#target"><span class="unknown">target</span></a><span class="text.normal"> until the given </span><a class="factor-local" href="#Log.undo.Parameters.quantity"><span class="parameter">quantity</span></a><span class="text.line-break"> </span><span class="text.normal">of checkpoints have been traversed or the beginning of the log has been</span><span class="text.line-break"> </span><span class="text.normal">reached.</span></p></section><section class="method" documented="true" local-identifier="redo" id="Log.redo"><h1><span class="prefix"></span><a class="section" href="#Log">Log</a><a class="title" href="#Log.redo"><span class="text.normal">redo</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">redo(self, target)</code></p><p><span class="text.normal">Replay delta records effecting </span><a class="factor-local" href="#Log.redo.Parameters.target"><span class="parameter">target</span></a><span class="text.normal"> until the given </span><a class="factor-local" href="#Log.redo.Parameters.quantity"><span class="parameter">quantity</span></a><span class="text.line-break"> </span><span class="text.normal">of checkpoints have been traversed or the end of the log has been</span><span class="text.line-break"> </span><span class="text.normal">reached.</span></p></section></section><h1 class="footing"></h1></main></body></html>