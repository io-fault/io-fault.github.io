<html root="2"><head><title>system.chapters.daemon</title><meta charset="utf-8"/><link as="style" rel="preload" href="../../.legacy-web/core.css"></link><link as="style" rel="preload" href="../../.legacy-web/factor.css"></link><link rel="stylesheet" href="../../.legacy-web/core.css"></link><link rel="stylesheet" href="../../.legacy-web/factor.css"></link></head><body><main><h1><span class="prefix"></span><div class="page-subject"><img class="icon" src="../../.factor-type-icon/if.fault.io/python-module.svg"></img><span class="subject-identifier">daemon</span><span class="element-status"><span class="nothing-missed">0</span></span><a href="http://if.fault.io/factors/python.module"><code class="type">python.module</code></a></div><div class="page-context"><a href="../"><img class="icon" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNTYiIGhlaWdodD0iMjU2Ij48dGV4dCB4PSI0IiB5PSIwLjg4ZW0iIGZvbnQtc2l6ZT0iMjQ4Ij7wn5OaPC90ZXh0Pjwvc3ZnPg=="></img></a><span class="context-identifier">system.chapters</span></div></h1><section class="chapter"><p><span class="text.normal">Web application for serving a project corpus.</span></p></section><section class="import" documented="false" local-identifier="json" id="json"><h1><span class="prefix"></span><a class="title" href="#json"><span class="text.normal">json</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">import</span></div></h1></section><section class="import" documented="false" local-identifier="zipfile" id="zipfile"><h1><span class="prefix"></span><a class="title" href="#zipfile"><span class="text.normal">zipfile</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">import</span></div></h1></section><section class="import" documented="false" local-identifier="collections" id="collections"><h1><span class="prefix"></span><a class="title" href="#collections"><span class="text.normal">collections</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">import</span></div></h1></section><section class="import" documented="false" local-identifier="itertools" id="itertools"><h1><span class="prefix"></span><a class="title" href="#itertools"><span class="text.normal">itertools</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">import</span></div></h1></section><section class="import" documented="false" local-identifier="dataclass" id="dataclass"><h1><span class="prefix"></span><a class="title" href="#dataclass"><span class="text.normal">dataclass</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">import</span></div></h1></section><section class="import" documented="false" local-identifier="files" id="files"><h1><span class="prefix"></span><a class="title" href="#files"><span class="text.normal">files</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">import</span></div></h1></section><section class="import" documented="false" local-identifier="service" id="service"><h1><span class="prefix"></span><a class="title" href="#service"><span class="text.normal">service</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">import</span></div></h1></section><section class="import" documented="false" local-identifier="system" id="system"><h1><span class="prefix"></span><a class="title" href="#system"><span class="text.normal">system</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">import</span></div></h1></section><section class="import" documented="false" local-identifier="html" id="html"><h1><span class="prefix"></span><a class="title" href="#html"><span class="text.normal">html</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">import</span></div></h1></section><section class="function" documented="false" local-identifier="render_factor_html" id="render_factor_html"><h1><span class="prefix"></span><a class="title" href="#render_factor_html"><span class="text.normal">render_factor_html</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">render_factor_html(prefix, depth, styles, type, identifier, chapter)</code></p></section><section class="function" documented="false" local-identifier="buffer" id="buffer"><h1><span class="prefix"></span><a class="title" href="#buffer"><span class="text.normal">buffer</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">buffer(iterator)</code></p></section><section class="class" documented="true" local-identifier="Select" id="Select"><h1><span class="prefix"></span><a class="title" href="#Select"><span class="text.normal">Select</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">class</span></div></h1><div class="inheritance"><code class="type"><a class="invalid" href="#object"><span class="unknown">object</span></a></code></div><p><span class="text.normal">Corpus selection structure separating project, factor, and source.</span></p><section class="unspecified" documented="true" local-identifier="Properties" id="Select.Properties"><h1 class="integrate"><span class="prefix"></span><a class="section" href="#Select">Select</a><a class="title" href="#Select.Properties"><span class="text.normal">Properties</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type"></span></div></h1><dl class="text.mapping"><div id="Select.Properties.project" documented="true"><dt><a class="dkn" href="#Select.Properties.project"></a><span class="directory-key"><span class="text.normal">project</span></span></dt><dd><div class="status"></div><p><span class="text.normal">The first path component of the request URI.</span><span class="text.line-break"> </span><span class="text.normal">Empty string if root.</span></p></dd></div><div id="Select.Properties.factor" documented="true"><dt><a class="dkn" href="#Select.Properties.factor"></a><span class="directory-key"><span class="text.normal">factor</span></span></dt><dd><div class="status"></div><p><span class="text.normal">The second path component of the request URI.</span><span class="text.line-break"> </span><a class="invalid" href="#None"><span class="unknown">None</span></a><span class="text.normal"> if there is no second component or it's an empty string.</span></p></dd></div><div id="Select.Properties.source" documented="true"><dt><a class="dkn" href="#Select.Properties.source"></a><span class="directory-key"><span class="text.normal">source</span></span></dt><dd><div class="status"></div><p><span class="text.normal">The third and remaining path components as a string.</span><span class="text.line-break"> </span><a class="invalid" href="#None"><span class="unknown">None</span></a><span class="text.normal"> if there is no third component or it's an empty string.</span></p></dd></div><div id="Select.Properties.index" documented="true"><dt><a class="dkn" href="#Select.Properties.index"></a><span class="directory-key"><span class="text.normal">index</span></span></dt><dd><div class="status"></div><p><span class="text.normal">Boolean designating whether or not a trailing slash was present.</span></p></dd></div></dl></section><section class="data" documented="false" local-identifier="project" id="Select.project"><h1><span class="prefix"></span><a class="section" href="#Select">Select</a><a class="title" href="#Select.project"><span class="text.normal">project</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div><code class="type"><a class="invalid" href="#str"><span class="unknown">str</span></a></code></h1><pre class="text.syntax"><code class="source">project: str = None
</code></pre></section><section class="data" documented="false" local-identifier="factor" id="Select.factor"><h1><span class="prefix"></span><a class="section" href="#Select">Select</a><a class="title" href="#Select.factor"><span class="text.normal">factor</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div><code class="type"><a class="invalid" href="#str"><span class="unknown">str</span></a></code></h1><pre class="text.syntax"><code class="source">factor: str = None
</code></pre></section><section class="data" documented="false" local-identifier="source" id="Select.source"><h1><span class="prefix"></span><a class="section" href="#Select">Select</a><a class="title" href="#Select.source"><span class="text.normal">source</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div><code class="type"><a class="invalid" href="#str"><span class="unknown">str</span></a></code></h1><pre class="text.syntax"><code class="source">source: str = None
</code></pre></section><section class="data" documented="false" local-identifier="index" id="Select.index"><h1><span class="prefix"></span><a class="section" href="#Select">Select</a><a class="title" href="#Select.index"><span class="text.normal">index</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div><code class="type"><a class="invalid" href="#bool"><span class="unknown">bool</span></a></code></h1><pre class="text.syntax"><code class="source">index: bool = None
	@classmethod
</code></pre></section><section class="classmethod" documented="true" local-identifier="from_request_uri" id="Select.from_request_uri"><h1><span class="prefix"></span><a class="section" href="#Select">Select</a><a class="title" href="#Select.from_request_uri"><span class="text.normal">from_request_uri</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">classmethod</span></div></h1><p><code class="signature">from_request_uri(Class, rpath)</code></p><p><span class="text.normal">Identify the project, factor, and source selected by the path.</span></p></section><section class="property" documented="true" local-identifier="depth" id="Select.depth"><h1><span class="prefix"></span><a class="section" href="#Select">Select</a><a class="title" href="#Select.depth"><span class="text.normal">depth</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">property</span></div></h1><p><span class="text.normal">The number of path components.</span></p></section><section class="method" documented="false" local-identifier="factorpath" id="Select.factorpath"><h1><span class="prefix"></span><a class="section" href="#Select">Select</a><a class="title" href="#Select.factorpath"><span class="text.normal">factorpath</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">factorpath(self)</code></p></section><section class="method" documented="false" local-identifier="factorjoin" id="Select.factorjoin"><h1><span class="prefix"></span><a class="section" href="#Select">Select</a><a class="title" href="#Select.factorjoin"><span class="text.normal">factorjoin</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">factorjoin(self, *paths)</code></p></section><section class="method" documented="true" local-identifier="archivepath" id="Select.archivepath"><h1><span class="prefix"></span><a class="section" href="#Select">Select</a><a class="title" href="#Select.archivepath"><span class="text.normal">archivepath</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">archivepath(self, plural, primary, factortype)</code></p><p><span class="text.normal">Calculate the archive path from the given project, factor, source triple.</span></p></section><section class="method" documented="true" local-identifier="readmeta" id="Select.readmeta"><h1><span class="prefix"></span><a class="section" href="#Select">Select</a><a class="title" href="#Select.readmeta"><span class="text.normal">readmeta</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">readmeta(self, corpus)</code></p><p><span class="text.normal">Retrieve the .meta.json entry for the factor being referenced.</span></p></section><section class="method" documented="true" local-identifier="readchapter" id="Select.readchapter"><h1><span class="prefix"></span><a class="section" href="#Select">Select</a><a class="title" href="#Select.readchapter"><span class="text.normal">readchapter</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">readchapter(self, corpus, meta)</code></p><p><span class="text.normal">Retrieve the chapter for the given identifier.</span></p></section><section class="method" documented="true" local-identifier="catchapters" id="Select.catchapters"><h1><span class="prefix"></span><a class="section" href="#Select">Select</a><a class="title" href="#Select.catchapters"><span class="text.normal">catchapters</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">catchapters(self, corpus, meta)</code></p><p><span class="text.normal">Catenate the chapters of all the source files.</span></p></section></section><section class="data" documented="false" local-identifier="media_types" id="media_types"><h1><span class="prefix"></span><a class="title" href="#media_types"><span class="text.normal">media_types</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">media_types = {
	'json': b'application/json',
	'txt': b'text/plain',
	'html': b'text/html',
	'css': b'text/css',
	'svg': b'image/svg+xml',
	'png': b'image/png',
}
</code></pre></section><section class="function" documented="false" local-identifier="r_icon" id="r_icon"><h1><span class="prefix"></span><a class="title" href="#r_icon"><span class="text.normal">r_icon</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">r_icon(sx, icons)</code></p></section><section class="function" documented="false" local-identifier="removeprefix" id="removeprefix"><h1><span class="prefix"></span><a class="title" href="#removeprefix"><span class="text.normal">removeprefix</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">removeprefix(prefix, string)</code></p></section><section class="function" documented="false" local-identifier="r_projects" id="r_projects"><h1><span class="prefix"></span><a class="title" href="#r_projects"><span class="text.normal">r_projects</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">r_projects(prefix, sx, partition, index)</code></p></section><section class="function" documented="false" local-identifier="f_icon" id="f_icon"><h1><span class="prefix"></span><a class="title" href="#f_icon"><span class="text.normal">f_icon</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">f_icon(sx, partition, type)</code></p></section><section class="function" documented="false" local-identifier="r_factors" id="r_factors"><h1><span class="prefix"></span><a class="title" href="#r_factors"><span class="text.normal">r_factors</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">r_factors(sx, partition, index)</code></p></section><section class="function" documented="false" local-identifier="r_sources" id="r_sources"><h1><span class="prefix"></span><a class="title" href="#r_sources"><span class="text.normal">r_sources</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">function</span></div></h1><p><code class="signature">r_sources(sx, index)</code></p></section><section class="class" documented="true" local-identifier="Corpus" id="Corpus"><h1><span class="prefix"></span><a class="title" href="#Corpus"><span class="text.normal">Corpus</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">class</span></div></h1><div class="inheritance"><code class="type"><a class="remote" href="http://fault.io/python/web/service#Partition"><span class="factor-element">service.Partition</span></a></code></div><p><span class="text.normal">Corpus application providing access to a set of projects and their factors.</span></p><section class="data" documented="false" local-identifier="Archive" id="Corpus.Archive"><h1><span class="prefix"></span><a class="section" href="#Corpus">Corpus</a><a class="title" href="#Corpus.Archive"><span class="text.normal">Archive</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">data</span></div></h1><pre class="text.syntax"><code class="source">Archive = zipfile.ZipFile
	@staticmethod
</code></pre></section><section class="staticmethod" documented="false" local-identifier="cp_parse_arguments" id="Corpus.cp_parse_arguments"><h1><span class="prefix"></span><a class="section" href="#Corpus">Corpus</a><a class="title" href="#Corpus.cp_parse_arguments"><span class="text.normal">cp_parse_arguments</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">staticmethod</span></div></h1><p><code class="signature">cp_parse_arguments(argv)</code></p></section><section class="method" documented="false" local-identifier="structure" id="Corpus.structure"><h1><span class="prefix"></span><a class="section" href="#Corpus">Corpus</a><a class="title" href="#Corpus.structure"><span class="text.normal">structure</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">structure(self)</code></p></section><section class="method" documented="false" local-identifier="cp_update" id="Corpus.cp_update"><h1><span class="prefix"></span><a class="section" href="#Corpus">Corpus</a><a class="title" href="#Corpus.cp_update"><span class="text.normal">cp_update</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">cp_update(self, route)</code></p></section><section class="method" documented="false" local-identifier="part_dispatched" id="Corpus.part_dispatched"><h1><span class="prefix"></span><a class="section" href="#Corpus">Corpus</a><a class="title" href="#Corpus.part_dispatched"><span class="text.normal">part_dispatched</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">part_dispatched(self, argv)</code></p></section><section class="method" documented="false" local-identifier="cp_read_json" id="Corpus.cp_read_json"><h1><span class="prefix"></span><a class="section" href="#Corpus">Corpus</a><a class="title" href="#Corpus.cp_read_json"><span class="text.normal">cp_read_json</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">cp_read_json(self, path)</code></p></section><section class="method" documented="true" local-identifier="cp_read" id="Corpus.cp_read"><h1><span class="prefix"></span><a class="section" href="#Corpus">Corpus</a><a class="title" href="#Corpus.cp_read"><span class="text.normal">cp_read</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">cp_read(self, path)</code></p><p><span class="text.normal">Read a resource from the configured archive.</span></p></section><section class="method" documented="false" local-identifier="cp_send_resource" id="Corpus.cp_send_resource"><h1><span class="prefix"></span><a class="section" href="#Corpus">Corpus</a><a class="title" href="#Corpus.cp_send_resource"><span class="text.normal">cp_send_resource</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">cp_send_resource(self, ctl, path)</code></p></section><section class="method" documented="false" local-identifier="cp_send_html" id="Corpus.cp_send_html"><h1><span class="prefix"></span><a class="section" href="#Corpus">Corpus</a><a class="title" href="#Corpus.cp_send_html"><span class="text.normal">cp_send_html</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">cp_send_html(self, ctl, depth, chapter, factorpath, factortype)</code></p></section><section class="method" documented="true" local-identifier="cp_project_index" id="Corpus.cp_project_index"><h1><span class="prefix"></span><a class="section" href="#Corpus">Corpus</a><a class="title" href="#Corpus.cp_project_index"><span class="text.normal">cp_project_index</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">cp_project_index(self, ctl)</code></p><p><span class="text.normal">Handle root HTML requests.</span></p></section><section class="method" documented="true" local-identifier="cp_factor_index" id="Corpus.cp_factor_index"><h1><span class="prefix"></span><a class="section" href="#Corpus">Corpus</a><a class="title" href="#Corpus.cp_factor_index"><span class="text.normal">cp_factor_index</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">cp_factor_index(self, project, ctl)</code></p><p><span class="text.normal">Handle root HTML requests.</span></p></section><section class="method" documented="true" local-identifier="cp_source_index" id="Corpus.cp_source_index"><h1><span class="prefix"></span><a class="section" href="#Corpus">Corpus</a><a class="title" href="#Corpus.cp_source_index"><span class="text.normal">cp_source_index</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">cp_source_index(self, project, factor, ctl)</code></p><p><span class="text.normal">Handle root HTML requests.</span></p></section><section class="method" documented="false" local-identifier="part_select" id="Corpus.part_select"><h1><span class="prefix"></span><a class="section" href="#Corpus">Corpus</a><a class="title" href="#Corpus.part_select"><span class="text.normal">part_select</span></a><span class="element-status"></span><div class="factor-element-meta"><span class="abstract-type">method</span></div></h1><p><code class="signature">part_select(self, ctl)</code></p></section></section><h1 class="footing"></h1></main></body></html>